---
import "../styles/global.css";
import Header from "../components/Header.astro";
import SeasonBanner from "../components/SeasonBanner.astro";
import StickyCta from "../components/StickyCta.astro";
import Footer from "../components/Footer.astro";

import { site, getSiteCopy } from "../data/site";
import en from "../i18n/en";

const t = en;
const copy = getSiteCopy("en");

const title = `${site.name} – ${copy.tagline}`;
const desc = copy.description;
const year = new Date().getFullYear();
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <link rel="preload" as="image" href="/hero/1-hero.jpg" />

    <title>{title}</title>
    <meta name="description" content={desc} />
    <link rel="canonical" href="https://sallysbar.gr/" />

    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="/favicon/site.webmanifest" />

    <meta property="og:title" content={title} />
    <meta property="og:description" content={desc} />
    <meta property="og:type" content="website" />

    <script
      type="application/ld+json"
      set:html={JSON.stringify({
        "@context": "https://schema.org",
        "@type": "BarOrPub",
        name: site.name,
        address: {
          "@type": "PostalAddress",
          streetAddress: site.addressShort,
          addressLocality: "Skala",
          addressRegion: "Kefalonia",
          postalCode: "28086",
          addressCountry: "GR",
        },
        telephone: site.phoneE164,
        url: "https://sallysbar.gr",
      })}
    />
  </head>

  <body class="min-h-screen bg-[#0b0b10] text-white font-body">
    <Header />

    <!-- HERO -->
    <section class="relative overflow-hidden">
      <img
        id="hero-image"
        src="/hero/1-hero.jpg"
        alt={t.home.heroAlt}
        class="absolute inset-0 h-full w-full object-cover transition-opacity duration-700 opacity-100"
        loading="eager"
      />

      <div class="absolute inset-0 bg-black/50"></div>

      <div class="relative mx-auto max-w-6xl px-6 py-32 md:py-40">
        <div class="text-xs uppercase tracking-[0.25em] text-white/60">
          {t.home.locationLine}
        </div>

        <div class="mt-4 flex items-center gap-4">
          <img
            src="/logo/1-logo.png"
            alt="Sally's Bar logo"
            class="h-12 w-12 md:h-16 md:w-16"
            loading="eager"
          />
          <h1 class="text-5xl font-semibold leading-tight md:text-7xl">
            {site.name}
          </h1>
        </div>

        <p class="mt-6 max-w-2xl text-xl text-white/70">
          <span class="text-white font-semibold">{copy.tagline}</span><br />
          {t.home.heroSubline}
        </p>

        <div class="mt-6">
          <SeasonBanner
            isOpenNow={site.season.isOpenNow}
            opensFromText={copy.opensFromText}
          />
        </div>

        <!-- CTA -->
        <div class="mt-8 flex flex-wrap gap-3 items-center">
          <a
            href={site.mapsShareUrl}
            target="_blank"
            class="rounded-2xl bg-white px-6 py-3 font-semibold text-black hover:bg-white/90"
          >
            {t.home.ctaDirections}
          </a>

          <a
            href={`tel:${site.phoneE164}`}
            class="rounded-2xl border border-white/20 px-6 py-3 font-semibold hover:bg-white/10"
          >
            {t.home.ctaCall}
          </a>
        </div>

        <!-- Social links -->
        <div class="mt-4 flex flex-wrap gap-2 text-sm">
          <a href={site.socials.instagram} target="_blank" class="rounded-full border border-white/15 px-4 py-2 text-white/80 hover:bg-white/10">
            {t.home.linkInstagram}
          </a>
          <a href={site.socials.facebook} target="_blank" class="rounded-full border border-white/15 px-4 py-2 text-white/80 hover:bg-white/10">
            {t.home.linkFacebook}
          </a>
          <a href={site.socials.tripadvisor} target="_blank" class="rounded-full border border-white/15 px-4 py-2 text-white/80 hover:bg-white/10">
            {t.home.linkTripadvisor}
          </a>
          <a href={site.reviews.googleUrl} target="_blank" class="rounded-full border border-white/15 px-4 py-2 text-white/80 hover:bg-white/10">
            {t.home.linkGoogleReviews}
          </a>
        </div>

        <!-- Social proof -->
        <div class="mt-8 flex flex-wrap gap-3 text-sm text-white/70">
          <div class="rounded-full border border-white/10 px-3 py-1">
            ⭐ {site.ratings.google.rating} {t.home.googleRatingLabel}
          </div>
          <div class="rounded-full border border-white/10 px-3 py-1">
            {copy.hoursText}
          </div>
          <div class="rounded-full border border-white/10 px-3 py-1">
            {site.addressFull}
          </div>
        </div>

        <!-- Early / Late -->
        <div class="mt-8 grid gap-3 md:max-w-2xl md:grid-cols-2">
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="text-sm font-semibold">{t.home.earlyTitle}</div>
            <div class="mt-1 text-sm text-white/70">{t.home.earlyText}</div>
          </div>
          <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
            <div class="text-sm font-semibold">{t.home.lateTitle}</div>
            <div class="mt-1 text-sm text-white/70">{t.home.lateText}</div>
          </div>
        </div>

        <div class="mt-6">
          <div class="inline-block rounded-full border border-white/20 px-5 py-2 text-sm">
            {t.home.pricePill}
          </div>
        </div>

        <p class="mt-4 text-sm text-white/70">{t.home.ukLine}</p>
      </div>
    </section>

    <Footer />

    <StickyCta
      mapsUrl={site.mapsShareUrl}
      phoneE164={site.phoneE164}
      instagramUrl={site.socials.instagram}
      facebookUrl={site.socials.facebook}
      tripadvisorUrl={site.socials.tripadvisor}
      googleUrl={site.socials.google}
      isOpenNow={site.season.isOpenNow}
    />

    <!-- HERO ROTATION -->
    <script is:inline>
      (() => {
        const hero = document.getElementById("hero-image");
        if (!hero) return;

        const HERO_COUNT = 10;
        const INTERVAL = 5000;

        let current = Math.floor(Math.random() * HERO_COUNT) + 1;

        setInterval(() => {
          let next;
          do {
            next = Math.floor(Math.random() * HERO_COUNT) + 1;
          } while (next === current);

          hero.classList.remove("opacity-100");
          hero.classList.add("opacity-0");

          setTimeout(() => {
            hero.src = `/hero/${next}-hero.jpg`;
            hero.classList.remove("opacity-0");
            hero.classList.add("opacity-100");
            current = next;
          }, 700);
        }, INTERVAL);
      })();
    </script>
  </body>
</html>